{% extends 'base.html.twig' %}

{% block title %}Changer mon mot de passe - TaskFlow
{% endblock %}

{% block body %}
	{# MODIFICATION : Ajout de la classe auth-container pour activer le chargement automatique d'auth.js #}
	<div class="container change-password-page auth-container">
		<div class="row justify-content-center">
			<div class="col-md-6 col-lg-5">
				<div class="card border-0 shadow-sm auth-card">
					<div class="card-header bg-danger text-white">
						<h4 class="card-title mb-0">
							<i class="fas fa-lock me-2"></i>Changer mon mot de passe
						</h4>
					</div>
					<div class="card-body p-4">
						<div class="text-center mb-4">
							<div class="bg-danger bg-opacity-10 rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
								<i class="fas fa-shield-alt text-danger fa-2x"></i>
							</div>
							<p class="text-muted">Pour votre sécurité, saisissez votre mot de passe actuel puis le nouveau</p>
						</div>

						<div class="alert alert-info">
							<i class="fas fa-info-circle me-2"></i>
							<strong>Conseils pour un mot de passe sécurisé :</strong>
							<ul class="mb-0 mt-2">
								<li>Au moins 8 caractères</li>
								<li>Mélange de lettres, chiffres et symboles</li>
								<li>Évitez les informations personnelles</li>
							</ul>
						</div>

						<form method="post" class="form-container form-profile needs-validation" novalidate>
							<div class="mb-3">
								<label for="current_password" class="form-label fw-semibold required-field">
									<i class="fas fa-key me-1 text-danger"></i>Mot de passe actuel
								</label>
								<div class="auth-input-group input-group">
									<span class="input-group-text bg-light">
										<i class="fas fa-lock text-muted"></i>
									</span>
									<input type="password" class="form-control" id="current_password" name="current_password" placeholder="Votre mot de passe actuel" required>
									<button class="btn btn-outline-secondary" type="button" onclick="togglePassword('current_password')">
										<i class="fas fa-eye" id="current_password_icon"></i>
									</button>
								</div>
								<div class="form-text">Saisissez votre mot de passe actuel pour confirmer votre identité</div>
							</div>

							<div class="mb-3">
								<label for="new_password" class="form-label fw-semibold required-field">
									<i class="fas fa-plus-circle me-1 text-success"></i>Nouveau mot de passe
								</label>
								<div class="auth-input-group input-group">
									<span class="input-group-text bg-light">
										<i class="fas fa-lock text-muted"></i>
									</span>
									<input type="password" class="form-control" id="new_password" name="new_password" placeholder="Votre nouveau mot de passe" minlength="6" required>
									<button class="btn btn-outline-secondary" type="button" onclick="togglePassword('new_password')">
										<i class="fas fa-eye" id="new_password_icon"></i>
									</button>
								</div>
								<div class="progress mt-2 password-strength-bar">
									<div id="password_strength" class="progress-bar" style="width: 0%"></div>
								</div>
								<div class="form-text" id="password_help">Minimum 6 caractères requis</div>
							</div>

							<div class="mb-4">
								<label for="confirm_password" class="form-label fw-semibold required-field">
									<i class="fas fa-check-circle me-1 text-success"></i>Confirmer le nouveau mot de passe
								</label>
								<div class="auth-input-group input-group">
									<span class="input-group-text bg-light">
										<i class="fas fa-lock text-muted"></i>
									</span>
									<input type="password" class="form-control" id="confirm_password" name="confirm_password" placeholder="Confirmez votre nouveau mot de passe" required>
									<button class="btn btn-outline-secondary" type="button" onclick="togglePassword('confirm_password')">
										<i class="fas fa-eye" id="confirm_password_icon"></i>
									</button>
								</div>
								<div class="form-text" id="confirm_help">Les mots de passe doivent être identiques</div>
							</div>

							<div class="form-actions">
								<div class="d-flex justify-content-between align-items-center">
									<a href="{{ path('user_profile') }}" class="btn btn-outline-secondary btn-form">
										<i class="fas fa-arrow-left me-2"></i>Annuler
									</a>
									<button type="submit" class="btn btn-danger btn-lg auth-btn">
										<i class="fas fa-save me-2"></i>Changer le mot de passe
									</button>
								</div>
							</div>
						</form>
					</div>
				</div>

				<div class="card border-0 bg-light mt-4">
					<div class="card-body">
						<h6 class="card-title">
							<i class="fas fa-shield-alt text-success me-2"></i>Sécurité de votre compte
						</h6>
						<div class="auth-security-icons">
							<div class="auth-security-icon">
								<i class="fas fa-lock text-primary"></i>
								<p class="small mb-0">Chiffrement</p>
							</div>
							<div class="auth-security-icon">
								<i class="fas fa-user-shield text-success"></i>
								<p class="small mb-0">Protection</p>
							</div>
							<div class="auth-security-icon">
								<i class="fas fa-eye-slash text-warning"></i>
								<p class="small mb-0">Confidentialité</p>
							</div>
						</div>
					</div>
				</div>

				<div class="card border-0 shadow-sm mt-4">
					<div class="card-header bg-white">
						<h6 class="card-title mb-0">
							<i class="fas fa-lightbulb me-2 text-warning"></i>Conseils de sécurité
						</h6>
					</div>
					<div class="card-body">
						<ul class="mb-0 small">
							<li>Ne partagez jamais votre mot de passe avec personne</li>
							<li>Utilisez un mot de passe unique pour TaskFlow</li>
							<li>Changez votre mot de passe régulièrement</li>
							<li>Déconnectez-vous sur les ordinateurs publics</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}